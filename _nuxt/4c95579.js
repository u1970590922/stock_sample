(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{518:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(196);var r=Object.freeze({ASC:"ASC",DESC:"DESC"})},519:function(e,t,n){"use strict";n(101);var r=n(38),o=n(39),c=n(40),l=n(55),f=n(50),h=n(33),m=(n(3),n(8),n(245),n(98),n(152)),d=n(70),v=n(518),_=(n(35),n(520)),x=n(249),y=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(o.a)(this,e),this._storeName=t,this._config=n,this._dbName="demo",this._version=1,this._dbo=null}var t,n,l,f,h,m,d;return Object(c.a)(e,[{key:"_openDB",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._storeName,n=this._config,e.next=4,Object(_.b)(this._dbName,this._version,{upgrade:function(e){var r=e.createObjectStore(t,{keyPath:"id",autoIncrement:!0});n.indexs.forEach((function(e){r.createIndex(e.name,e.name,{unique:e.unique})}))}});case 4:this._dbo=e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"_closeDB",value:function(){null!=this._dbo&&(this._dbo.close(),this._dbo=null)}},{key:"deleteDB",value:(m=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._closeDB(),e.next=3,Object(_.a)(this._dbName);case 3:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"getAll",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,cursor,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:v.a.DESC,e.prev=1,t===v.a.ASC&&(n="push"),n="unshift",e.next=5,this._openDB();case 5:return r=[],e.next=8,this._dbo.transaction(this._storeName).store.openCursor();case 8:cursor=e.sent;case 9:if(!cursor){e.next=16;break}return r[n](cursor.value),e.next=13,cursor.continue();case 13:cursor=e.sent,e.next=9;break;case 16:return e.abrupt("return",r);case 17:return e.prev=17,this._closeDB(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[1,,17,20]])}))),function(){return h.apply(this,arguments)})},{key:"getById",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._openDB();case 3:return e.next=5,this._dbo.get(this._storeName,t);case 5:return e.abrupt("return",e.sent);case 6:return e.prev=6,this._closeDB(),e.finish(6);case 9:case"end":return e.stop()}}),e,this,[[0,,6,9]])}))),function(e){return f.apply(this,arguments)})},{key:"create",value:(l=Object(r.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._openDB();case 3:return data.created_at=Object(x.a)(new Date),data.updated_at=null,e.next=7,this._dbo.add(this._storeName,data);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,this._closeDB(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[0,,8,11]])}))),function(e){return l.apply(this,arguments)})},{key:"update",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._openDB();case 3:return data.updated_at=Object(x.a)(new Date),e.next=6,this._dbo.put(this._storeName,data);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,this._closeDB(),e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[0,,7,10]])}))),function(e){return n.apply(this,arguments)})},{key:"destroy",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._openDB();case 2:return e.next=4,this._dbo.delete(this._storeName,t);case 4:this._closeDB();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}t.a=new(function(e){Object(l.a)(_,e);var t,n,f,h=w(_);function _(){return Object(o.a)(this,_),h.call(this,"stock",{indexs:[{name:"commodity_id",unique:!1}]})}return Object(c.a)(_,[{key:"getByCommodityId",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._openDB();case 3:return e.next=5,this._dbo.getAllFromIndex(this._storeName,"commodity_id",t);case 5:return e.abrupt("return",e.sent);case 6:return e.prev=6,this._closeDB(),e.finish(6);case 9:case"end":return e.stop()}}),e,this,[[0,,6,9]])}))),function(e){return f.apply(this,arguments)})},{key:"getSumOfCommodityId",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._openDB();case 3:return e.next=5,this._dbo.getAllFromIndex(this._storeName,"commodity_id",t);case 5:return n=e.sent,e.abrupt("return",Object(m.sum)(Object(m.map)(n,"quantity")));case 7:return e.prev=7,this._closeDB(),e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[0,,7,10]])}))),function(e){return n.apply(this,arguments)})},{key:"getStatus",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var data,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAll(v.a.ASC);case 2:return data=e.sent,t={},Object.values(d.a).forEach((function(e){t[e]=0})),data.forEach((function(e){t[e.commodity_id]+=e.quantity})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),_}(y))},544:function(e,t){},629:function(e,t,n){"use strict";n.r(t);var r=n(38),o=(n(98),n(3),n(8),n(245),n(244),n(590)),c=n.n(o),l=n(152),f=n(518),h=n(70),m=n(519),d={data:function(){return{panel:[0,1]}},methods:{exportDataToExcel:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$overlay.show(),t.next=3,m.a.getAll(f.a.ASC);case 3:n=t.sent,Object(l.isEmpty)(n)||(r=[],Object.values(h.a).forEach((function(t){r.push({commodity_id:t,commodity_name:Object(l.filter)(e.$store.state.stock.commodityDropdown,["value",t])[0].text,quantity:0})})),n.forEach((function(t){return t.commodity_name=Object(l.filter)(e.$store.state.stock.commodityDropdown,["value",t.commodity_id])[0].text,t.type_name=Object(l.filter)(e.$store.state.stock.stockTypeDropdown,["value",t.type])[0].text,r[r.findIndex((function(e){return e.commodity_id==t.commodity_id}))].quantity+=t.quantity,t})),c()([{sheet:"庫存狀態",columns:[{label:"商品名稱",value:"commodity_name"},{label:"剩餘數量",value:"quantity"}],content:r},{sheet:"庫存明細",columns:[{label:"商品名稱",value:"commodity_name"},{label:"類型",value:"type_name"},{label:"數量",value:"quantity"},{label:"描述",value:"description"},{label:"建立時間",value:"created_at"},{label:"更新時間",value:"updated_at"}],content:n}],{fileName:"庫存紀錄"}),e.$snackbar.show("下載成功")),e.$overlay.close();case 6:case"end":return t.stop()}}),t)})))()},resetDatabase:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.deleteDB();case 2:e.$snackbar.show("重置成功");case 3:case"end":return t.stop()}}),t)})))()}}},v=n(29),_=n(36),x=n.n(_),y=n(229),w=n(620),k=n(247),O=n(233),j=n(531),D=n(621),R=n(622),B=n(623),E=n(624),C=n(225),component=Object(v.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-card",{staticClass:"mx-auto mt-4"},[n("v-expansion-panels",{attrs:{multiple:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("匯出紀錄")]),e._v(" "),n("v-expansion-panel-content",[n("v-banner",{attrs:{"two-line":""},scopedSlots:e._u([{key:"actions",fn:function(){return[n("v-btn",{attrs:{text:"",color:"blue"},on:{click:e.exportDataToExcel}},[e._v("\n                                確定\n                            ")])]},proxy:!0}])},[n("v-avatar",{attrs:{slot:"icon",color:"deep-purple accent-4",size:"40"},slot:"icon"},[n("v-icon",{attrs:{icon:"mdi-lock",color:"white"}},[e._v("\n                                mdi-microsoft-excel\n                            ")])],1),e._v("\n                        把目前所有庫存狀態、紀錄匯出成Excel檔案\n                        ")],1)],1)],1),e._v(" "),n("v-expansion-panel",[n("v-expansion-panel-header",[e._v("重置資料庫")]),e._v(" "),n("v-expansion-panel-content",[n("v-banner",{attrs:{"two-line":""},scopedSlots:e._u([{key:"actions",fn:function(){return[n("v-btn",{attrs:{text:"",color:"blue"},on:{click:e.resetDatabase}},[e._v("\n                                確定\n                            ")])]},proxy:!0}])},[n("v-avatar",{attrs:{slot:"icon",color:"red",size:"40"},slot:"icon"},[n("v-icon",{attrs:{icon:"mdi-lock",color:"white"}},[e._v("\n                                mdi-database-remove-outline\n                            ")])],1),e._v("\n                        點選按鈕之後，將會移除所有紀錄，並重置整個資料庫，請謹慎使用!\n                        ")],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;x()(component,{VAvatar:y.a,VBanner:w.a,VBtn:k.a,VCard:O.a,VContainer:j.a,VExpansionPanel:D.a,VExpansionPanelContent:R.a,VExpansionPanelHeader:B.a,VExpansionPanels:E.a,VIcon:C.a})}}]);